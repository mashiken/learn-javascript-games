<!DOCTYPE html>
<html>
<body>
<canvas id="canvas"></canvas>
<script>

    const FIELD_COL = 10;
    const FIELD_ROW = 20;

    const BLOCK_SIZE = 30;
    const TETRO_SIZE = 4;

    const SCREEN_W = BLOCK_SIZE * FIELD_COL;
    const SCREEN_H = BLOCK_SIZE * FIELD_ROW;

    let canvas = document.getElementById("canvas");
    let ctx = canvas.getContext("2d");

    canvas.width = SCREEN_W;
    canvas.height = SCREEN_H;
    canvas.setAttribute('style','display:block;margin:auto;background-color: #ddd; border:4px solid #555');


    let tetro = [
        [0,0,0,0],
        [1,1,0,0],
        [0,1,1,0],
        [0,0,0,0]
    ];

    let tetro_x = 0;
    let tetro_y = 0;
    
    let field = [];
    init();
    field[7][7] = 1;
    field[19][9] = 1;
    drawAll();

    function init()
    {
        for(let y=0; y<FIELD_ROW; y++)
        {
            field[y] = [];
            for(let x=0; x<FIELD_COL; x++)
            {
                field[y][x] = 0;
            }

        }
    }

    function drawBlock(x,y)
    {
        {
            let px = x * BLOCK_SIZE;
            let py = y * BLOCK_SIZE;

            ctx.fillStyle="red";
            ctx.fillRect(px,py, BLOCK_SIZE, BLOCK_SIZE);
    
            ctx.strokeStyle="black";
            ctx.strokeRect(px,py, BLOCK_SIZE, BLOCK_SIZE);
        }

    }

    function drawAll()
    {
        ctx.clearRect(0,0,SCREEN_W,SCREEN_H);
        for(let y=0; y<FIELD_ROW; y++)
        {
            for(let x=0; x<FIELD_COL; x++)
            {
                if( field[y][x] )
                {
                    drawBlock(x,y);
                }
            }   
        }

        for(let y=0; y<TETRO_SIZE; y++)
        {
            for(let x=0; x<TETRO_SIZE; x++)
            {
                if( tetro[y][x] )
                {
                    drawBlock(tetro_x + x,tetro_y + y);
                }
            }   
        }
    }

    function checkMove( mx, my )
    {
        for(let y=0; y<TETRO_SIZE; y++)
        {
            for(let x=0; x<TETRO_SIZE; x++)
            {
                let nx = tetro_x + mx + x;
                let ny = tetro_y + my + y;
                if( tetro[y][x] )
                {
                    if( field[ny][nx] ||
                        ny < 0 ||
                        nx < 0 ||
                        ny >= FIELD_ROW ||
                        nx >= FIELD_COL ) 
                    {
                        return false;
                    }
                }
            }   
        }
        return true;
    }


    document.onkeydown = function(e){
        switch( e.keyCode )
        {
            case 37:
                if( checkMove(-1, 0) )tetro_x--;
                break;
            case 38:
                if( checkMove( 0,-1) )tetro_y--;
                break;
            case 39:
                if( checkMove( 1, 0) )tetro_x++;
                break;
            case 40:
                if( checkMove( 0, 1) )tetro_y++;
                break;
            case 32:
                break;
            
        }
        drawAll();

    }
</script>
</body>
</html>